---
title: "Séries Temporais"
author: "Filipe Duarte"
date: "8/17/2019"
output:
  pdf_document: default
  html_document: default
---

# Atividade nº 1

Escolher 3 séries temporais no repositório TDSL.

```{r echo=FALSE, results='hide',message=FALSE}
devtools::install_github("FinYang/tsdl")
library(tsdl)
```

Uma série para cada tipo:

a. Com sazonalidade
b. Com tendência determinística
c. Série Financeira ou climática

Para cada série plotar:

a. A série própria e nas escalas de tempo: Mês e Ano.
b. ACF e PACF.
c. Série decomposta.
d. ACF sobre o resíduo da decomposição.

# 1ª Série: Com Sazonalidade

```{r echo=FALSE, results='hide',message=FALSE}
base <- subset(tsdl, "Meteorology")
dados <- ts(base[[5]], frequency = 12, start = c(1959, 1), end = c(1990,12))
```

A série selecionada com sazonalidade foi a 5ª série de Metereologia. Essa série representa a mensuração mensal de dióxido de carbono sobre Manua Loa, Hawaii, entre janeiro de 1959 e dezembro de 1990.

## Gráfico da série

Essa série possui uma tendência crescente como pode ser visto no gráfico abaixo. Além disso, possui sazonalidade, uma vez que possui picos e vales frequentes de mesmo padrão ao longo do ano. 


```{r echo=FALSE, results='hide',message=FALSE}
plot(base[[5]], ylab = "Emissão de Dióxido de Carbono", xlab = "Ano")
```

## Boxplot da série

Vamos visualizar no gráfico de boxplot abaixo quais meses representam os aumentos sazonais da emissão dióxido de carbono. 


```{r echo=FALSE, results='hide',message=FALSE}
boxplot(dados ~ cycle(dados), xlab = "Mês", main = "Gráfico Boxplot mensal")
```

Verificou-se um aumento na emissão do dióxido de carbono em maio e uma redução considerável da emissão nos meses de setembro e outubro. 

## Tendência da série 

O próximo elemento a ser analisado é a tendência da série. Obtém-se através da agregação dos dados mensais em anuais. 

```{r echo = FALSE, results = "hide", message=FALSE}
plot(aggregate(dados), ylab = "Emissão de Dióxido de Carbono", xlab = "Ano", main = "Gráfico da Tendência")
```

Diante do gráfico acima, verifica-se uma forte tendência crescente. Essa tendência apresenta um comportamento determinístico, pois não há uma quebra estrutural que demonstre uma inversão em sua direção. 

## Decomposição da série

No que diz respeito à decomposição da série temporal, foi realizada a decomposição aditiva, pelo fato da variância não aumentar ao longo do tempo, como pode-se verificar abaixo. 

```{r echo = FALSE, results="hide", message=FALSE}
plot(decompose(dados))
```

A decomposição aditiva é representada pela soma dos componentes: Tendência, Sazonalidade e Erro, como demonstra a equação a seguir:

$$ 
x_t = m_t + s_t + zt
$$
onde, $m_t$ é a tendência, $s_t$ é a sazonalidade e $z_t$ é o termo do erro. 

Desse gráfico, percebe-se a tendência crescente e com comportamento semelhante ao linear; sazonalidade expressiva relevando comportamento cíclico presente nos meses de maio e setembro/outubro. 

## gráfico da série entre xt e xt+1

```{r echo = FALSE, message=FALSE, results="hide"}
plot(dados[1:383], dados[2:384], xlab = "x_t", ylab = "x_t+1")
```

## Correlograma


O gráfico ACF apresenta no eixo x os lags e no eixo y, o valor da autocorrelação em cada lag. Portanto, conclui-se que ela possui elevados valores de autocorrelação serial. 
O gráfico da função de autocorrelação serial demonstra que a série possui um decaimento muito suave da autocorrelação, com forte autocorrelação em cada lag. Além disso, percebe-se a sazonalidade uma vez que a autocorrelação tende a aumentar em alguns lags.  

```{r echo = FALSE, results="hide", message=FALSE}
acf(dados, main = "ACF")
```

No que diz respeito ao PACF, função de autocorrelação parcial, verifica-se a perda de autocorrelação a partir do primeiro lag. Isso demonstra que a série tem forte autocorrelação com lag 1 e até com o lag 2 (de forma negativa).

```{r echo = FALSE, results="hide", message=FALSE}
pacf(dados, main = "PACF")
```

Sendo assim, os valores mais próximos, isto é, o lag 1 e o lag 2, são os que possuem as maiores autocorrelação. Entretanto, vale ressaltar que o lag 2 está correlacionado de forma negativa com os demais lags.  

## ACF sobre o resíduo da decomposição

A seguir, verifica-se o gráfico ACF para o resíduo da série.

```{r echo = FALSE, message=FALSE, results="hide"}
decomposicao_1 <- decompose(dados)
acf(decomposicao_1$random[!is.na(decomposicao_1$random)], main = "ACF sobre o resíduo da decomposição")
```

Percebe-se uma considerável autocorrelação entre a série e os lags 2, 5, 6 e 7. Contudo, há uma inversão do sinal do lag 2 em relação ao lag 5. 

# 2ª Série: com tendência determinística


```{r echo = FALSE, message=FALSE, results="hide"}
base2 <- subset(tsdl, "Demography")
dados2 <- base2[[1]]
```

A segunda série desta atividade possui uma tendência determinística. O seu gráfico lembra uma reta. 
A série é demográfica e representa a população civil autraliana, em milhares de pessoas, entre fevereiro de 1978 e abril de 1991.

```{r echo = FALSE, message=FALSE, results="hide"}
plot(dados2, ylab = "População australiana (em milhares)", xlab = "Ano")
```

## Boxplot da série

Vamos visualizar no gráfico de boxplot abaixo quais meses representam os aumentos sazonais da população civil australiana. 


```{r echo=FALSE, results='hide',message=FALSE}
boxplot(dados2 ~ cycle(dados2), xlab = "Mês", main = "Gráfico Boxplot mensal")
```

Não se verifica uma sazonalidade nesta série, pois o gráfico de bosplot não demonstra diferenças significativas entre os meses. Isso corrobora com o que foi verificado a partir do gráfico da série. 

## Tendência da série 

O próximo elemento a ser analisado é a tendência da série. Obtém-se através da agregação dos dados mensais em anuais. 

```{r echo = FALSE, results = "hide", message=FALSE}
plot(aggregate(dados2), ylab = "População civil australiana (em milhares)", xlab = "Ano", main = "Gráfico da Tendência")
```

É evidente que a série da população civil australiana é semlhante à tendência estimada para a própria série (gráfico acima). Sendo assim, será necessário realizar a decomposição da série para investigar o componente do ruído. 

## Decomposição da série

No que diz respeito à decomposição da série temporal, foi realizada a decomposição aditiva, pelo fato da variância não aumentar ao longo do tempo, como pode-se verificar abaixo. 

```{r echo = FALSE, results="hide", message=FALSE}
plot(decompose(dados2))
```

Desse gráfico, percebe-se a tendência crescente e com comportamento semelhante ao linear, que pode ser modelada por meio de uma regressão linear com o tempo. Verifica-se uma certa sazonalidade e um ruído com natureza estocástica, pois não há um padrão claro que o defina. 
